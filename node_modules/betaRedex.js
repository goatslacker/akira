var CallExpression = require('ast/CallExpression')
var FunctionExpression = require('ast/FunctionExpression')
var Identifier = require('ast/Identifier')
var MemberExpression = require('ast/MemberExpression')
var addScope = require('addScope')

function betaRedex(body, context) {
  if (context) {
    body = addScope(context, body);
  }
  var node = CallExpression(
    MemberExpression(
      FunctionExpression(null, [], body),
      Identifier('apply'),
      false
    ),
    [Identifier('this'), Identifier('arguments')]
  )
  node.__betaRedex = true
  return node
}

module.exports = betaRedex
